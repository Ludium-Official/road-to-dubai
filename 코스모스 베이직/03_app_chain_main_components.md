# 03. Main Components of App Chain

### Preview

**Hello Earth ðŸŒ!, Welcome to Cosmos ðŸŒŒ**, ì½”ìŠ¤ëª¨ìŠ¤ ë² ì´ì§ ê³¼ì • ì„¸ë²ˆì§¸ ì±•í„°ì— ì˜¨ ê±¸ í™˜ì˜í•œë‹¤.

ì´ì–´ì„œ ë‹¤ë£° ì£¼ì œëŠ” ì½”ìŠ¤ëª¨ìŠ¤ ì•±ì²´ì¸ì˜ ì•„í‚¤í…ì³ì´ë‹¤. ì´ë²ˆ ì‹œê°„ì—ëŠ” ê¸´ ë§ì€ ìƒëžµí•˜ê³  ë°”ë¡œ ì§„í–‰í•˜ë„ë¡ í•˜ìž.

### Cosmos-SDK Based App Chain Architecture

ì´ì œ ë“œë””ì–´ ì½”ìŠ¤ëª¨ìŠ¤ ì•± ì²´ì¸ì— ëŒ€í•œ ì•„í‚¤í…ì³ì— ëŒ€í•´ì„œ ì„¤ëª…í•  ì°¨ë¡€ê°€ ë˜ì—ˆë‹¤.

ì•„ëž˜ ê·¸ë¦¼ì€ ì´ë¯¸ ì§€ë‚œ ì‹œê°„ ë§ˆì§€ë§‰ì— ë³´ì•˜ë˜ ê·¸ë¦¼ì´ë‹¤. ë”°ë¼ì„œ, ìˆ˜ê°•ìƒë“¤ ëˆˆì— ì¢€ ë” ìµìˆ™í•´ì¡Œì„ ê²ƒì´ë¼ê³  ë³¸ë‹¤. ðŸ‘€ ðŸ‘€ ðŸ‘€ ðŸ‘

```sh
                ^  +-------------------------------+  ^
                |  |                               |  |   Built with Cosmos SDK
                |  |  State-machine = Application  |  |
                |  |                               |  v
                |  +-------------------------------+
                |  |                               |  ^
Blockchain node |  |           Consensus           |  |
                |  |                               |  |
                |  +-------------------------------+  |   CometBFT
                |  |                               |  |
                |  |           Networking          |  |
                |  |                               |  |
                v  +-------------------------------+  v
```

ë¨¼ì € ì§šê³  ë„˜ì–´ê°ˆ í¬ì¸íŠ¸ëŠ” ìœ„ì˜ êµ¬ì¡°ë¥¼ ì•„ëž˜ì™€ ê°™ì´ ìž¬êµ¬ì„±í•´ë³´ëŠ” ê²ƒì´ë‹¤.

ìš°ë¦¬ê°€ ì¼ë°˜ì ìœ¼ë¡œ ì•±ì²´ì¸ì´ë¼ê³  ë¶€ë¥´ëŠ” ì´ìœ ëŠ” ì•„ëž˜ì˜ Consensus & Networking Level(=CometBFT or Tendermint Level)ë¥¼ ê°œë°œìžì˜ ìž…ìž¥ì—ì„œ ìµœëŒ€í•œ ì‹ ê²½ì“°ì§€ ì•Šê³  ì–´í”Œë¦¬ì¼€ì´ì…˜ì— ì§‘ì¤‘í•´ì„œ ê°œë°œí•  ìˆ˜ ìžˆê¸° ë•Œë¬¸ì´ë‹¤.

ë”± ì¼ë°˜ì ì¸ ê°œë°œì—ì„œì˜ SDKì˜ ì„±ê²©ê³¼ ê°™ë‹¤ê³  ë³¼ ìˆ˜ ìžˆë‹¤. ë‹¤ë§Œ, ëŒ€ë¶€ë¶„ì˜ Cosmos SDKì—ì„œëŠ” ìœ„ì—ì„œ ì´ë¯¸ ë§ì”€ë“œë ¸ë˜ ëŒ€ë¡œ CometBFT(=Tendermint) ë¥¼ ì»¨ì„¼ì„œìŠ¤ë¡œ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ë¶€ë¶„ì ìœ¼ë¡œ ê°œë°œìžë“¤ë„ DPoSì˜ ê°œë…ê³¼ PBFTì˜ ê°œë…ì— ëŒ€í•´ì„œ ìˆ™ì§€í•  í•„ìš”ê°€ ìžˆê¸°ë„ í•˜ë‹¤.

í•˜ì§€ë§Œ, ë‹¹ìž¥ì— ìš°ë¦¬ê°€ ì•±ì²´ì¸ì„ ê°œë°œí•˜ëŠ”ë° í•„ìš”í•˜ì§„ ì•Šê¸° ë•Œë¬¸ì— ìƒëžµí•˜ê³  ë„˜ì–´ê°€ë„ë¡ í•˜ìž.

(ì´ ë¶€ë¶„ì— ëŒ€í•´ì„œ ì¢€ ë” ê´€ì‹¬ì´ ìžˆìœ¼ì‹  ë¶„ë“¤ì€ ì´ [ë§í¬](https://docs.cometbft.com/v0.37/introduction/what-is-cometbft)ë¥¼ í†µí•´ì„œ ë¯¸ë¦¬ í•œë²ˆ ë³´ëŠ” ê²ƒë„ ì¢‹ì„ ê²ƒì´ë‹¤)

(+ì•žìœ¼ë¡œëŠ” Tendermintê°€ ì•„ë‹Œ CometBFTë¡œ í†µì¼í•´ì„œ ë§í•˜ë„ë¡ í•˜ê² ë‹¤)

```sh
              +---------------------+
              |                     |
              |     Application     |       -> Cosmos-SDK
              |                     |
              +--------+---+--------+
                       ^   |
                       |   | ABCI
                       |   v
              +--------+---+--------+
              |                     |
              |                     |
              |       CometBFT      |
              |                     |
              |                     |
              +---------------------+
```

### ABCI(Application Blockchain Interface)

ì§€ë‚œ ì‹œê°„ê³¼ ì´ë²ˆì‹œê°„ì„ í†µí•´ ìš°ë¦° Cosmos-SDKë¥¼ ì´ìš©í•œ ì•±ì²´ì¸ êµ¬ì¡°ì— ëŒ€í•´ì„œ ë§Žì´ ì•Œê²Œ ë˜ì—ˆë‹¤ê³  ë³¼ ìˆ˜ ìžˆë‹¤.

ëˆˆì¹˜ê°€ ë¹ ë¥´ì‹  ê°œë°œìžë¶„ë“¤ì´ë¼ë©´ ëˆˆì¹˜ë¥¼ ì±˜ì„ ê²ƒ ê°™ì€ë°, ìš°ë¦¬ê°€ ë§Œë“¤ ì–´í”Œë¦¬ì¼€ì´ì…˜ ë ˆë²¨ì˜ appchainê³¼ ì‹¤ì§ˆì ì¸ ì»¨ì„¼ì„œìŠ¤ë¥¼ ë‹´ë‹¹í•˜ëŠ” cometbftë ˆë²¨ì€ ABCIë¼ê³  í•˜ëŠ” interfaceë¡œ ë¶„ë¦¬ê°€ ë˜ì–´ìžˆë‹¤.

ë”°ë¼ì„œ, ì €ë²ˆì—ë„ ë§í–ˆë“¯ì´ ë°˜ë“œì‹œ CometBFT & Cosmos-SDK based application ì¡°í•©ì„ êµ¬ì„±í•  í•„ìš”ëŠ” ì—†ìœ¼ë©° ìŒìœ¼ë¡œ ëœ ì¸í„°íŽ˜ì´ìŠ¤ë§Œì„ ì¤€ìˆ˜í•œë‹¤ë©´ ì–´ë–¤ ì¡°í•©ì´ë˜ ê°€ëŠ¥í•˜ëŠ” ë§ì´ë‹¤.

ë‹¤ë§Œ Ethereumê³¼ ê°™ì´ ì—¬ëŸ¬ languageë¡œ êµ¬ì„±ëœ clientsì˜ ë¶€ìž¬ë¡œ ëŒ€ë¶€ë¶„ CometBFT & Cosmos-SDK ì¡°í•©ìœ¼ë¡œ ì²´ì¸ì´ ê°œë°œë˜ê³  ìžˆëŠ” ìƒí™©ì´ë‹¤.

ê·¸ë ‡ì§€ë§Œ, ìž¬ë¯¸ë‚œ ì ì€ ABCIì— ì¡´ìž¬í•œë‹¤. ìµœê·¼, Cosmos Ecocsystemìƒì—ì„œ ì£¼ëª©ë°›ê³  ìžˆëŠ” ì²´ì¸ë“¤ì€ ëŒ€ë¶€ë¶„ ABCI++ë¼ê³  í•˜ëŠ” ê¸°ì¡´ ABCIì—ì„œ ë³´ë‹¤ í™•ìž¥ëœ ABCI extension, ABCI++ë¥¼ ë„ìž…í•˜ê³  ìžˆë‹¤.

ì´ì— ê´€í•´ì„œëŠ” [ê³¼ì œ](./homework/03.md)ë¡œ ë‚¼ ì˜ˆì •ì´ë‹ˆ, ê°ìž ì°¾ì•„ë³´ê³  ë‹¤ìŒì‹œê°„ì— ê³µìœ í•˜ëŠ” ì‹œê°„ì„ ê°€ë„ë¡ í•˜ìž.

> The ABCI also allows developers to swap the consensus engine of their application-specific blockchain. Today, only CometBFT is production-ready, but in the future other consensus engines are expected to emerge.

ABCIë¥¼ ê´€ë ¨ëœ ë‚´ìš©ì„ ëë§ˆì¹˜ê¸° ì „ì— ì•Œê³  ë„˜ì–´ê°€ì•¼í•  ë‚´ìš©ì— ëŒ€í•´ì„œëŠ” ì„¤ëª…í•˜ë„ë¡ í•˜ê² ë‹¤.

> Note that CometBFT only handles transaction bytes. It has no knowledge of what these bytes mean. All CometBFT does is order these transaction bytes deterministically. CometBFT passes the bytes to the application via the ABCI, and expects a return code to inform it if the messages contained in the transactions were successfully processed or not.

ìœ„ ì˜ì–´ë¡œ ëœ ë‚´ìš©ì—ì„œ ë³´ì…¨ë“¯ì´ ì´ëŸ° í˜•íƒœë¡œ ABCI ì¸í„°íŽ˜ì´ìŠ¤ë¥¼ í†µí•´ì„œ ê° ë…¸ë“œ í´ë¼ì´ì–¸íŠ¸ê°€ ë™ìž‘í•œë‹¤ê³  ìœ ì¶”í•  ìˆ˜ ìžˆë‹¤.

ì¦‰, ê¸°ë³¸ì ì¸ ë¸”ë¡ì²´ì¸ì˜ ë™ìž‘ì´ ë‘ ê³„ì¸µì˜ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ì„ í†µí•´ì„œ ì´ë¤„ì§„ë‹¤ëŠ” ë§ì´ë‹¤. (ì•„ëž˜ ë„ì‹ì˜ í™”ì‚´í‘œë¥¼ ì£¼ëª©í•˜ìž)

```sh
                   +---------------------+
                   |                     |
                   |     Application     |       -> Cosmos-SDK
                   |                     |
                   +--------+---+--------+
        (ABCI)              ^   |             (ABCI)
received transaction bytes->|   | <- return codes(success or not)
                            |   v
                   +--------+---+--------+
                   |                     |
                   |                     |
                   |       CometBFT      |
                   |                     |
                   |                     |
                   +---------------------+
```

ì •ë§ ë§ˆì§€ë§‰ìœ¼ë¡œ! ABCIì˜ ê°€ìž¥ ì¤‘ìš”í•œ ë©”ì‹œì§€ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.
(ë‹¤ë§Œ, í•œë²ˆë§Œ ìŠ¤~ìœ½ ì½ê³  ë„˜ì–´ê°€ìž ë‹¹ìž¥ì— ì•Œ í•„ìš”ì—†ëŠ” êµì–‘ì§€ì‹ ê°™ì€ ë‚´ìš©ì´ë‹¤)

- CheckTx: CometBFTê°€ íŠ¸ëžœìž­ì…˜ì„ ë°›ìœ¼ë©´, ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì „ë‹¬ë˜ì–´ ëª‡ ê°€ì§€ ê¸°ë³¸ ìš”êµ¬ ì‚¬í•­ì„ ì¶©ì¡±í•˜ëŠ”ì§€ í™•ì¸í•œë‹¤. CheckTxëŠ” í’€ ë…¸ë“œì˜ ë©”ëª¨í’€ì„ ìŠ¤íŒ¸ íŠ¸ëžœìž­ì…˜ìœ¼ë¡œë¶€í„° ë³´í˜¸í•˜ëŠ” ë° ì‚¬ìš©ëœë‹¤. AnteHandlerë¼ëŠ” íŠ¹ë³„í•œ í•¸ë“¤ëŸ¬ê°€ ì¶©ë¶„í•œ ìˆ˜ìˆ˜ë£Œ í™•ì¸ ë° ì„œëª… ê²€ì¦ê³¼ ê°™ì€ ì¼ë ¨ì˜ ê²€ì¦ ë‹¨ê³„ë¥¼ ì‹¤í–‰í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ”ë°, ê²€ì¦ì´ ìœ íš¨í•˜ë©´ íŠ¸ëžœìž­ì…˜ì´ ë©”ëª¨í’€ì— ì¶”ê°€ë˜ê³  í”¼ì–´ ë…¸ë“œì— ë¦´ë ˆì´ëœë‹¤. CheckTxì—ì„œëŠ” íŠ¸ëžœìž­ì…˜ì´ ë¸”ë¡ì— í¬í•¨ë˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— ìƒíƒœê°€ ìˆ˜ì •ë˜ì§€ ì•ŠëŠ”ë‹¤.

- DeliverTx: CometBFTê°€ ìœ íš¨í•œ ë¸”ë¡ì„ ë°›ìœ¼ë©´, ë¸”ë¡ì˜ ê° íŠ¸ëžœìž­ì…˜ì€ DeliverTxë¥¼ í†µí•´ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì „ë‹¬ë˜ì–´ ì²˜ë¦¬ëœë‹¤. ì´ ë‹¨ê³„ì—ì„œ ìƒíƒœ ì „í™˜ì´ ë°œìƒí•˜ëŠ”ë° ì´ë•Œ AnteHandlerê°€ ë‹¤ì‹œ ì‹¤í–‰ë˜ë©°, íŠ¸ëžœìž­ì…˜ì˜ ê° ë©”ì‹œì§€ì— ëŒ€í•œ ì‹¤ì œ Msg ì„œë¹„ìŠ¤ RPCë„ ì‹¤í–‰ëœë‹¤.

- BeginBlock/EndBlock: ì´ ë©”ì‹œì§€ëŠ” ë¸”ë¡ì´ íŠ¸ëžœìž­ì…˜ì„ í¬í•¨í•˜ë“  ì•Šë“  ê° ë¸”ë¡ì˜ ì‹œìž‘ê³¼ ëì—ì„œ ì‹¤í–‰ëœë‹¤. ìžë™ìœ¼ë¡œ ë¡œì§ì„ ì‹¤í–‰í•˜ëŠ” ë° ìœ ìš©í•˜ë‹¤. ê·¸ëŸ¬ë‚˜ ê³„ì‚°ì ìœ¼ë¡œ ë¹„ì‹¼ ë£¨í”„ëŠ” ë¸”ë¡ì²´ì¸ì„ ëŠë¦¬ê²Œ í•˜ê±°ë‚˜ ë£¨í”„ê°€ ë¬´í•œí•˜ë©´ ë¸”ë¡ì²´ì¸ì„ ë©ˆì¶œ ìˆ˜ ìžˆìœ¼ë¯€ë¡œ ì£¼ì˜í•´ì„œ ì‚¬ìš©í•´ì•¼ í•œë‹¤.

ë” ìžì„¸í•œ ABCI ë©”ì„œë“œì— ëŒ€í•œ ì„¤ëª…ì€ CometBFT ë¬¸ì„œì—ì„œ í™•ì¸í•  ìˆ˜ ìžˆê³ , ê°„ë‹¨ížˆ ABCIì— êµ¬í˜„ëœ CheckTxì™€ DeliverTxë¥¼ í†µí•´ì„œ interface methodê°€ êµ¬ì„±ë˜ì–´ ìžˆë‹¤ê³ ë§Œ ë³´ë©´ ë  ê²ƒì´ë‹¤.

ê·¸ë ‡ë‹¤ë©´, **ê°œë°œìžë“¤ë¡œì„œ ì´ëŸ¬í•œ ì¸í„°íŽ˜ì´ìŠ¤ë¥¼ í•­ìƒ ìžê¸°ì˜ appchain applicationë ˆë²¨(app.go)ì—ì„œ êµ¬í˜„í•´ì•¼í•œë‹¤ê³  ìƒê°í•  ìˆ˜ë„ ìžˆê² ì§€ë§Œ. ë‹¤í–‰ížˆë„ ABCI ì¸í„°íŽ˜ì´ìŠ¤ë¥¼ ì§ì ‘ êµ¬í˜„í•  í•„ìš”ëŠ” ì—†ê³ ** Cosmos SDKì—ì„œ ì œê³µí•´ì£¼ëŠ” baseappì„ í™•ìž¥í•´ì„œ ìš°ë¦¬ ì•±ì²´ì¸ì˜ êµ¬ì¡°ì²´ë¡œ ì‚¬ìš©í•˜ë©´ ëœë‹¤.

### Main Components of Cosmos SDK

ì´ì œ Cosmos SDKì˜ êµ¬ì„±ìš”ì†Œì— ëŒ€í•´ì„œ ì•Œì•„ë³´ìž.

Cosmos-SDKì˜ ì£¼ìš” êµ¬ì„± ìš”ì†ŒëŠ” í¬ê²Œ 3ê°€ì§€ ì •ë„ê°€ ìžˆë‹¤.

1. baseapp
2. multistore
3. modules

ëª¨ë“  ë‚´ìš©ì„ ì´ë²ˆ ì•„í‹°í´ì—ì„œ ê¹Šìˆ™ížˆ ë°°ìš°ì§€ëŠ” ì•Šì„ ê²ƒì´ê³ , ìœ„ì˜ ë§¥ë½ê³¼ ì´ì–´ì§€ëŠ” ë¶€ë¶„ë§Œ ë‹¤ë£¨ë„ë¡ í•˜ê² ë‹¤.

ìš°ì„ ! ìš°ë¦° ìœ„ì—ì„œ ì´ë¯¸ Cosmos-SDKë¥¼ ì´ìš©í•œ ì•± ì²´ì¸ ì–´í”Œë¦¬ì¼€ì´ì…˜ì´ application ë ˆë²¨ê³¼ cometbftë ˆë²¨ë¡œ ë‚˜ë‰˜ì–´ì§„ ì•„í‚¤í…ì³ë¥¼ ë°°ì› ìœ¼ë‹ˆ, ì´ì œ ê·¸ëŸ¼ ê·¸ ì•„í‚¤í…ì³ ìƒì—ì„œ íŠ¸ëžœìž­ì…˜ì´ ì–´ë–»ê²Œ ì²˜ë¦¬ë˜ëŠ”ì§€ ìˆœì„œë¥¼ ì•Œì•„ë³´ë„ë¡ í•˜ìž.

```sh
                   +---------------------+
                   |                     |
                   |     Application     |       -> Cosmos-SDK
                   |                     |
                   +--------+---+--------+
        (ABCI)              ^   |             (ABCI)
received transaction bytes->|   | <- return codes(success or not)
                            |   v
                   +--------+---+--------+
                   |                     |
                   |                     |
                   |       CometBFT      |
                   |                     |
                   |                     |
                   +---------------------+
```

Cosmos SDK ìœ„ì— êµ¬ì¶•ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ CometBFTë¥¼ í†µí•´ DeliverTxë¡œ ì „ì†¡ëœ íŠ¸ëžœìž­ì…˜ì´ ì²˜ë¦¬ë˜ëŠ” ë°©ì‹ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

1. CometBFT í•©ì˜ ì—”ì§„ì—ì„œ ë°›ì€ `transactions`ì„ ë””ì½”ë”©í•œë‹¤ (CometBFTëŠ” `[]bytes`ë§Œ ë‹¤ë£¹ë‹ˆë‹¤).
2. `transactions`ì—ì„œ `messages`ë¥¼ ì¶”ì¶œí•˜ê³  ê¸°ë³¸ì ì¸ ë¬´ê²°ì„± ê²€ì‚¬ë¥¼ ìˆ˜í–‰í•œë‹¤.
3. ê° `messages`ë¥¼ ì ì ˆí•œ ëª¨ë“ˆë¡œ ë¼ìš°íŒ…í•˜ì—¬ ì²˜ë¦¬í•œë‹¤.
4. ìƒíƒœ ë³€ê²½ì„ ì»¤ë°‹í•œë‹¤.

ìž ê·¸ëŸ¼ ì´ì œ í•˜ë‚˜ì”© ë©”ì¸ ì»´í¬ë„ŒíŠ¸ë¥¼ ì‚´íŽ´ë³´ìž!

#### 1. BaseApp

ë¨¼ì €, ë‚´ìš©ì€ BaseAppì´ë‹¤. baseappì€ Cosmos SDK ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ í‘œì¤€ êµ¬í˜„ì´ë‹¤. ì´ëŠ” ê¸°ë³¸ í•©ì˜ ì—”ì§„ê³¼ì˜ ì—°ê²°ì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ABCIì˜ êµ¬í˜„ì„ ì œê³µí•œë‹¤. ì¼ë°˜ì ìœ¼ë¡œ Cosmos SDK ì• í”Œë¦¬ì¼€ì´ì…˜ì€ app.go íŒŒì¼ì—ì„œ baseappì„ í¬í•¨í•˜ì—¬ í™•ìž¥í•©ë‹ˆë‹¤. (ê·¸ëž˜ì„œ ê° ê°œë°œìžë“¤ì´ êµ³ì´ ABCI êµ¬í˜„ì„ ì¼ì¼ì´ ë‹¤ ë§Œë“¤ í•„ìš”ê°€ ì—†ë‹¤)

ë‹¤ìŒì€ Cosmos SDK ë°ëª¨ ì• í”Œë¦¬ì¼€ì´ì…˜ì¸ simappì—ì„œì˜ ì˜ˆì‹œì´ë‹¤:
(ì—¬ê¸°ì„  ìžì„¸ížˆ ì‚´íŽ´ë³´ì§€ëŠ” ì•Šê³  ì§€ë‚œë²ˆ ì²˜ëŸ¼ ëˆˆìœ¼ë¡œë§Œ ìµí˜€ë‘ë„ë¡ í•˜ìž!)

```go
// SimApp extends an ABCI application, but with most of its parameters exported.
// They are exported for convenience in creating helper functions, as object
// capabilities aren't needed for testing.
type SimApp struct {
	*baseapp.BaseApp
	legacyAmino       *codec.LegacyAmino
	appCodec          codec.Codec
	txConfig          client.TxConfig
	interfaceRegistry types.InterfaceRegistry

	// keys to access the substores
	keys  map[string]*storetypes.KVStoreKey
	tkeys map[string]*storetypes.TransientStoreKey

	// keepers
	AccountKeeper         authkeeper.AccountKeeper
	BankKeeper            bankkeeper.Keeper
	StakingKeeper         *stakingkeeper.Keeper
	SlashingKeeper        slashingkeeper.Keeper
	MintKeeper            mintkeeper.Keeper
	DistrKeeper           distrkeeper.Keeper
	GovKeeper             govkeeper.Keeper
	CrisisKeeper          *crisiskeeper.Keeper
	UpgradeKeeper         *upgradekeeper.Keeper
	ParamsKeeper          paramskeeper.Keeper
	AuthzKeeper           authzkeeper.Keeper
	EvidenceKeeper        evidencekeeper.Keeper
	FeeGrantKeeper        feegrantkeeper.Keeper
	GroupKeeper           groupkeeper.Keeper
	NFTKeeper             nftkeeper.Keeper
	ConsensusParamsKeeper consensusparamkeeper.Keeper
	CircuitKeeper         circuitkeeper.Keeper

	// the module manager
	ModuleManager      *module.Manager
	BasicModuleManager module.BasicManager

	// simulation manager
	sm *module.SimulationManager

	// module configurator
	configurator module.Configurator
}
```

#### 2. Multistore

Cosmos SDKì—ì„œëŠ” ë¸”ë¡ì²´ì¸ì˜ ìƒíƒœë¥¼ ì˜êµ¬ì ìœ¼ë¡œ ì €ìž¥í•˜ê¸° ìœ„í•œ ë©€í‹°ìŠ¤í† ì–´ë¥¼ ì œê³µí•œë‹¤.

Multistoreëž€ ê°œë°œìžê°€ ì›í•˜ëŠ” ê°œìˆ˜ë§Œí¼ KVStoresë¥¼ ì„ ì–¸í•  ìˆ˜ ìžˆê²Œ í•˜ëŠ” ê²ƒì´ë‹¤.
(ë³¸ì¸ì˜ ì•±ì²´ì¸ ê°œë°œ êµ¬í˜„ì²´ì— ë”°ë¼ì„œ ì›í•˜ëŠ” ë§Œí¼ì˜ storeë¥¼ kvstoresë¡œ ë¶€í„° í• ë‹¹ ë°›ì•„ì„œ ì‚¬ìš©í•œë‹¤ê³  ë³´ë©´ ëœë‹¤)

ì´ëŸ¬í•œ KVStoresëŠ” ê°’ìœ¼ë¡œ `[]byte` íƒ€ìž…ë§Œì„ ìˆ˜ìš©í•˜ë¯€ë¡œ, ì €ìž¥í•˜ê¸° ì „ì— ì½”ë±ì„ ì‚¬ìš©í•˜ì—¬ ì»¤ìŠ¤í…€ êµ¬ì¡°ë¥¼ ë§ˆìƒ¬ë§(encoding)í•´ì•¼ í•œë‹¤. ë©€í‹°ìŠ¤í† ì–´ ìƒíƒœëŠ” ë¸”ë¡ê³¼ êµ¬ë¶„ë˜ì–´ìžˆì–´ì„œ, ê°ê°ì˜ ëª¨ë“ˆì—ì„œ ê´€ë¦¬ê°€ ë˜ëŠ”ë° ë³´ë‹¤ ìžì„¸í•œ ë‚´ìš©ì€ store articleì—ì„œ ë³´ë„ë¡ í•˜ìž.

#### 3. Modules

Cosmos SDKì˜ ê°•ì ì€ ëª¨ë“ˆì„±ì— ìžˆëŠ”ë°, ìš°ë¦¬ê°€ ìœ„ì—ì„œ ë°°ì› ë˜ ì•„í‚¤í…ì³ì— ë”°ë¼ Cosmos SDKëŠ” ê° ë©”ì‹œì§€ë¥¼ ì ì ˆí•œ ëª¨ë“ˆë¡œ ë¼ìš°íŒ…í•˜ëŠ” ì—­í• ì„ í•œë‹¤.

Cosmos SDK ì• í”Œë¦¬ì¼€ì´ì…˜ì¸ ì•±ì²´ì¸ë“¤ì€ ì—¬ëŸ¬ ëª¨ë“ˆì„ ëª¨ì•„ì„œ `app.go`ì—ì„œ ì„ ì–¸í•œ ë’¤ì— ì•±ì²´ì¸ì´ ìƒì„±ëœë‹¤. ê¸°ì¡´ì—ëŠ” í•œ ì•±ì²´ì¸ì— custom moduleì„ êµ¬í˜„í•˜ì˜€ìœ¼ë‚˜ ìµœê·¼ì—ëŠ” ê° ëª¨ë“ˆë“¤ì´ í•˜ë‚˜ì˜ libraryí˜•íƒœë¡œ ë¶„ë¦¬ë˜ì–´ ìžˆê¸°ë„í•´ì„œ ì´ì‹ì„±ì„ ì‚´ë¦¬ê¸°ë„ í•œë‹¤.

ê° ëª¨ë“ˆì€ ê¸°ë³¸ì ìœ¼ë¡œ Cosmos SDKì—ì„œ ì •ì˜í•œ interfaceë¥¼ ë§Œì¡±í•´ì•¼í•œë‹¤. ê·¸ë¦¬ê³  ëª¨ë“ˆ ìžì²´ì ìœ¼ë¡œ ëª¨ë“ˆ ìƒíƒœì— ëŒ€í•œ í•˜ìœ„ ì§‘í•©ì˜ ì •ì˜í•˜ê³  ìžì²´ `Messages/Transactions` processë“¤ì„ êµ¬í˜„í•˜ê²Œ ëœë‹¤.
(ë‚˜ì¤‘ì— ì½”ë“œë ˆë²¨ë„ ë³´ë©´ ì´í•´ê°€ ë í…Œë‹ˆ, ê° ëª¨ë“ˆë³„ë¡œ Cosmos-SDKê°€ ì •ì˜í•œ ê¸°ë³¸ì ì¸ ëª¨ë“ˆì˜ Intefaceë¥¼ ì¤€ìˆ˜í•´ì•¼í•œë‹¤ê³  ì •ë„ë§Œ ê¸°ì–µí•˜ìž)

ê° ëª¨ë“ˆì€ ìž‘ì€ ìƒíƒœ ê¸°ê³„ë¡œ ë³¼ ìˆ˜ ìžˆë‹¤. ê°œë°œìžëŠ” ëª¨ë“ˆì´ ì²˜ë¦¬í•˜ëŠ” ìƒíƒœì˜ í•˜ìœ„ ì§‘í•©ê³¼ ìƒíƒœë¥¼ ìˆ˜ì •í•˜ëŠ” ì»¤ìŠ¤í…€ ë©”ì‹œì§€ ìœ í˜•ì„ ì •ì˜í•´ì•¼ í•˜ëŠ”ë°, ì¼ë°˜ì ìœ¼ë¡œ ê° ëª¨ë“ˆì€ ë©€í‹°ìŠ¤í† ì–´ì— ìžì‹ ì˜ KVStoreë¥¼ ì„ ì–¸í•˜ì—¬ ì •ì˜ëœ ìƒíƒœì˜ í•˜ìœ„ ì§‘í•©ì„ ì˜êµ¬ ì €ìž¥í•œë‹¤.
(ìš°ë¦¬ ê°™ì€ ì•±ì²´ì¸ ê°œë°œìžë“¤ì€ ë£¨íŠ¸ ë©€í‹°ìŠ¤í† ì–´ì— ìžì‹ ì˜ kvstoreë¥¼ ì„ ì–¸í•´ì„œ ì‚¬ì‹¤ìƒ ëª¨ë“ˆ ë‚´ì—ì„œëŠ” storeëž€ ì¶”ìƒí™”ëœ êµ¬ì¡°ì²´ì— CRUDë¥¼ í•˜ë©´ ëœë‹¤)

ê²Œë‹¤ê°€ ì¼ë¶€ ëª¨ë“ˆì˜ ê²½ìš°ëŠ” ë‹¤ë¥¸ ì„œë“œ íŒŒí‹° ëª¨ë“ˆì— ëŒ€í•´ ì ‘ê·¼í•  í•„ìš”ìžˆë‹¤. ë”°ë¼ì„œ, ëª¨ë“ˆ ê°„ ìƒí˜¸ ìž‘ìš©ì— ëŒ€í•œ ë³´ì•ˆ ì›ì¹™ì´ í•„ìš”í•œë° ì´ë•Œ ë‹¤ë¥¸ ëª¨ë“ˆì„ ìœ„í•œ ì•¡ì„¸ìŠ¤ ì œì–´ ëª©ë¡ì„ ìœ ì§€í•˜ëŠ” ëŒ€ì‹ , ê° ëª¨ë“ˆì´ ë‹¤ë¥¸ ëª¨ë“ˆì— ì „ë‹¬ë  ìˆ˜ ìžˆëŠ” íŠ¹ìˆ˜ ê°ì²´ì¸ `keeper`ë¼ëŠ” ê²ƒì„ êµ¬í˜„í•˜ê³  ì‚¬ìš©í•˜ê²Œ ëœë‹¤. ë³´ë‹¤ ìžì„¸í•œ ë‚´ìš©ì€ ëª¨ë“ˆíŒŒíŠ¸ì—ì„œ ë‹¤ë£¨ë„ë¡ í•˜ìž!

ì•„! ë§ˆì§€ë§‰ìœ¼ë¡œ ê¸°ë³¸ì ìœ¼ë¡œ SDKì— ë‚´ìž¥ëœ ëª¨ë“ˆë“¤ì€ Cosmos SDKì˜ x/ í´ë”ì— ì •ì˜ë˜ëŠ”ë° ë ˆê±°ì‹œì´ë‹ˆ ì°¸ê³ ë¡œë§Œ ì•Œì•„ë‘ìž!

[ì´ ë§í¬](https://github.com/Ludium-Official/ludiumapp-chain)ë¥¼ ìž ê¹ ë“¤ì–´ê°€ë´ì„œ ë ˆí¬ì§€í† ë¦¬ì˜ êµ¬ì„±ì„ ë³¸ë‹¤ë©´ ë°”ë¡œ ì´í•´ë  ê²ƒì´ë‹¤.

### Overview App Chain Architecture

ëìœ¼ë¡œ ìš°ë¦¬ê°€ ì´ë²ˆ ì‹œê°„ì— ë°°ìš´ ë‚´ìš©ë“¤ì„ ì •ë¦¬í•œ ì•„í‚¤í…ì³ë¥¼ ë³´ëŠ” ê²ƒìœ¼ë¡œ ì•„í‹°í´ì„ ë§ˆì¹˜ë ¤ê³  í•œë‹¤. ì•„í‚¤í…ì³ ì´í•´ë¥¼ ìœ„í•´ ì´ [ì˜ìƒ](https://youtu.be/1_ottIKPfI4?si=XstKA2YGi2-yYKzF)ì„ í•œë²ˆì”© ë³´ëŠ” ê²ƒë„ ì¶”ì²œí•œë‹¤.

(ì´ëŸ¬ë©´ ì•ˆë³¼í…Œë‹ˆê¹Œ.. ì•„ëž˜ì˜ ë„ì‹í™” ì •ë„ë¼ë„ ëˆˆìœ¼ë¡œ ë°˜ë“œì‹œ ìµí˜€ë‘ìž! ðŸ‘€ ðŸ‘€ ðŸ‘€)

```sh
                +---------------------------------------------+
                |        CometBFT (Consensus & Networking)    |
                +---------------------|-----------------------+
                                      v
                                    ABCI Interface
                                      |
                                      v
                                      +
                                      |
                                      |  Transaction relayed from the full-node's
                                      |  CometBFT engine to the node's application
                                      |  via DeliverTx
                                      |
                                      |
                +---------------------v--------------------------+
                |                 APPLICATION                    |
                |                                                |
                |     Using baseapp's methods: Decode the Tx,    |
                |     extract and route the message(s)           |
                |                                                |
                +---------------------+--------------------------+
                                      |
                                      |
                                      |
                                      +---------------------------+
                                                                  |
                                                                  |
                                                                  |  Message routed to
                                                                  |  the correct module
                                                                  |  to be processed
                                                                  |
                                                                  |
+----------------+  +---------------+  +----------------+  +------v----------+
|                |  |               |  |                |  |                 |
|  AUTH MODULE   |  |  BANK MODULE  |  | STAKING MODULE |  |   GOV MODULE    |
|                |  |               |  |                |  |                 |
|                |  |               |  |                |  | Handles message,|
|                |  |               |  |                |  | Updates state   |
|                |  |               |  |                |  |                 |
+----------------+  +---------------+  +----------------+  +------+----------+
                                                                  |
                                                                  |
                                                                  |
                                                                  | (ABCI Interface)
                                       +--------------------------+
                                       |
                                       | Return result to CometBFT
                                       | (0=Ok, 1=Err)
                                       v
                +---------------------------------------------+
                |        CometBFT (Consensus & Networking)    |
                +---------------------------------------------+
```

### References

- https://docs.cosmos.network/v0.50/learn/intro/sdk-app-architecture
- https://docs.cosmos.network/v0.50/learn/intro/sdk-design
- https://docs.cometbft.com/v0.37/spec/abci/
- https://skip-protocol-docs.netlify.app/about/faq/
- https://informal.systems/blog/abci-v2-unlocks-this
